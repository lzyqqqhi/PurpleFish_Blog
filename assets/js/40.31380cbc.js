(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{359:function(s,t,r){"use strict";r.r(t);var a=r(27),_=Object(a.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"跨域"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#跨域"}},[s._v("#")]),s._v(" 跨域")]),s._v(" "),t("h2",{attrs:{id:"一、定义"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、定义"}},[s._v("#")]),s._v(" 一、定义")]),s._v(" "),t("p",[s._v("跨域指的是客户端脚本试图从与该脚本的 "),t("a",{attrs:{href:"https://so.csdn.net/so/search?q=origins&spm=1001.2101.3001.7020",target:"_blank",rel:"noopener noreferrer"}},[s._v("origins"),t("OutboundLink")],1),s._v("（协议、域名、端口）不同的源加载资源时所面临的安全限制。协议、域名、端口只要有一个不同，就属于跨域。")]),s._v(" "),t("h2",{attrs:{id:"二、产生原因"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、产生原因"}},[s._v("#")]),s._v(" 二、产生原因")]),s._v(" "),t("ol",[t("li",[t("strong",[s._v("同源策略")]),s._v(" ：出于安全考虑，浏览器的同源策略限制了从一个源加载的脚本获取或操作另一个源的资源。例如，当一个网页通过 "),t("a",{attrs:{href:"https://so.csdn.net/so/search?q=AJAX&spm=1001.2101.3001.7020",target:"_blank",rel:"noopener noreferrer"}},[s._v("AJAX"),t("OutboundLink")],1),s._v(" 请求或其他方式试图访问不同源的资源时，浏览器会阻止该请求。")]),s._v(" "),t("li",[t("strong",[s._v("浏览器安全机制")]),s._v(" ：现代浏览器遵循同源策略来防止恶意脚本获取用户敏感信息。跨域限制的目的是确保用户的隐私和数据安全。")])]),s._v(" "),t("h2",{attrs:{id:"三、常见跨域场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三、常见跨域场景"}},[s._v("#")]),s._v(" 三、常见跨域场景")]),s._v(" "),t("ol",[t("li",[t("strong",[s._v("不同域名")]),s._v(" ：如从域名 A（"),t("code",[s._v("www.example.com")]),s._v("）请求域名 B（"),t("code",[s._v("www.anotherdomain.com")]),s._v("）的资源。")]),s._v(" "),t("li",[t("strong",[s._v("不同协议")]),s._v(" ：从 HTTP 协议的页面请求 HTTPS 协议的资源，或者反之。")]),s._v(" "),t("li",[t("strong",[s._v("不同端口")]),s._v(" ：在同一域名下，但端口不同的两个应用之间进行通信。")])]),s._v(" "),t("h2",{attrs:{id:"四、解决方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#四、解决方法"}},[s._v("#")]),s._v(" 四、解决方法")]),s._v(" "),t("h3",{attrs:{id:"_1-cors-cross-origin-resource-sharing-跨域资源共享-主流且标准方法-常见请求头-响应头"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-cors-cross-origin-resource-sharing-跨域资源共享-主流且标准方法-常见请求头-响应头"}},[s._v("#")]),s._v(" 1. CORS（Cross - Origin Resource Sharing，跨域资源共享） - 主流且标准方法 常见请求头 响应头")]),s._v(" "),t("ul",[t("li",[t("p",[t("strong",[s._v("原理")]),s._v(" ：服务器响应时设置特定 HTTP 头，允许指定源的网页访问本资源。")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("核心 HTTP 响应头")]),s._v(" ：")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("Access - Control - Allow - Origin")]),s._v(" ：允许的域名。")]),s._v(" "),t("li",[t("strong",[s._v("Access - Control - Allow - Methods")]),s._v(" ：允许的方法（GET、POST 等）。")]),s._v(" "),t("li",[t("strong",[s._v("Access - Control - Allow - Headers")]),s._v(" ：允许携带的自定义头。")])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("示例")]),s._v(" ：")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("Access"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Control"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Allow"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("Origin"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" https"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("example"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com\n")])])])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("流程")]),s._v(" ：")]),s._v(" "),t("ul",[t("li",[s._v("浏览器发起跨域请求，服务器若带上正确的 CORS 响应头，浏览器则允许前端访问响应内容，否则拦截（前端拿不到响应数据）。")])])])]),s._v(" "),t("h3",{attrs:{id:"_2-jsonp-仅支持-get-老旧方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-jsonp-仅支持-get-老旧方式"}},[s._v("#")]),s._v(" 2. JSONP（仅支持 GET，老旧方式）")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("原理")]),s._v(" ：利用 "),t("code",[s._v("<script>")]),s._v(" 标签不受同源策略限制，通过回调函数获取数据。")]),s._v(" "),t("li",[t("strong",[s._v("实现方式")]),s._v(" ：\n"),t("ul",[t("li",[s._v("前端动态创建一个 "),t("code",[s._v("<script>")]),s._v(" 标签，将需要请求的 URL 设置为该标签的 "),t("code",[s._v("src")]),s._v(" 属性。")]),s._v(" "),t("li",[s._v("在 URL 后面添加一个回调函数名的参数，例如 "),t("code",[s._v("callback=handleResponse")]),s._v("。")]),s._v(" "),t("li",[s._v("服务器收到请求后，将数据作为参数，调用前端指定的回调函数，返回一个 JavaScript 脚本。")]),s._v(" "),t("li",[s._v("前端定义的回调函数会自动执行，从而获取到服务器返回的数据。")])])]),s._v(" "),t("li",[t("strong",[s._v("适用场景")]),s._v(" ：仅适合兼容性要求高、只用 GET 请求的场景。")])]),s._v(" "),t("h3",{attrs:{id:"_3-跨域资源嵌入"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-跨域资源嵌入"}},[s._v("#")]),s._v(" 3. 跨域资源嵌入")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("<img>、<link>、<script>、<iframe>")]),s._v(" 等资源本身可以加载不同源内容，但不能直接访问其内部数据。")]),s._v(" "),t("li",[s._v("利用 "),t("code",[s._v("postMessage")]),s._v(" 可实现 iframe 间安全通信。")])]),s._v(" "),t("h3",{attrs:{id:"_4-服务器代理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-服务器代理"}},[s._v("#")]),s._v(" 4. 服务器代理")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("原理")]),s._v(" ：前端请求自己的服务器，由服务器再去请求其他域的数据并转发给前端，实现 “同源”，绕过跨域限制。")])]),s._v(" "),t("h2",{attrs:{id:"五、cors-的类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#五、cors-的类型"}},[s._v("#")]),s._v(" 五、CORS 的类型")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("简单请求")]),s._v(" ：如 GET、POST（Content - Type 为 "),t("code",[s._v("application/x-www-form-urlencoded")]),s._v(", "),t("code",[s._v("multipart/form-data")]),s._v(", "),t("code",[s._v("text/plain")]),s._v("），会直接请求并由服务器决定是否放行。")]),s._v(" "),t("li",[t("strong",[s._v("预检请求（Preflight）")]),s._v(" ：对于复杂请求，浏览器会先发一个 OPTIONS 请求检测是否允许跨域，再决定是否发送实际请求。")])]),s._v(" "),t("h2",{attrs:{id:"六、面试标准答案模版"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#六、面试标准答案模版"}},[s._v("#")]),s._v(" 六、面试标准答案模版")]),s._v(" "),t("p",[s._v("浏览器为了安全采用同源策略，防止不同源之间的数据随意获取。若需要实现跨域资源共享，主流做法是由服务端设置 "),t("code",[s._v("Access-Control-Allow-Origin")]),s._v(" 等 CORS 相关 HTTP 响应头进行授权，浏览器检测到这些头部后允许前端获取响应数据。此外，还有 JSONP（仅 GET），iframe + postMessage、服务器代理等方案，但最推荐且最标准的是 CORS。")]),s._v(" "),t("h4",{attrs:{id:"注意事项"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#注意事项"}},[s._v("#")]),s._v(" 注意事项")]),s._v(" "),t("ul",[t("li",[s._v("CORS 必须服务端支持并设置相应头部，前端无法强制越权获得其他域数据")]),s._v(" "),t("li",[s._v("预检请求需妥善处理（尤其是企业级 API 或带 token 情况下）")]),s._v(" "),t("li",[s._v("CORS 还可控制允许的请求头、方法、是否携带凭证（如 cookie）")])])])}),[],!1,null,null,null);t.default=_.exports}}]);